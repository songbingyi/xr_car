/* @preserve
 * gcoord 0.0.2, a JS library for transform geographical coordinates.
 * Copyright (c) 2018 Jiulong Hu <me@hujiulong.com>
 */
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r(t.gcoord={})}(this,function(t){"use strict";var r="WGS84",e=r,n="GCJ02",o="BD09",i=r;function a(t,r){if(t)throw new Error(r)}function u(t){return!isNaN(t)&&null!==t&&!f(t)}function f(t){return!!t&&"[object Array]"===Object.prototype.toString.call(t)}function l(){var t=arguments,r=t.length-1;return function(){for(var e=r,n=t[r].apply(this,arguments);e--;)n=t[e].call(this,n);return n}}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c=function(){return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,r){var e=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(e.push(a.value),!r||e.length!==r);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&u.return&&u.return()}finally{if(o)throw i}}return e}(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),y=Math.sin,v=Math.cos,d=Math.sqrt,g=Math.abs,h=Math.PI,m=6378245,b=.006693421622965823;function p(t){var r=c(t,2),e=r[0],n=r[1];if(!G(e,n))return[e,n];for(var o=e,i=n,a=S([o,i]),u=a[0]-e,f=a[1]-n;g(u)>1e-6||g(f)>1e-6;)u=(a=S([o-=u,i-=f]))[0]-e,f=a[1]-n;return[o,i]}function S(t){var r=c(t,2),e=r[0],n=r[1];if(!G(e,n))return[e,n];var o,i,a,u,f,l,s,p,S,M,P,C,j,w=(j=300+(P=(o=e)-105)+2*(C=(i=n)-35)+.1*P*P+.1*P*C+.1*d(g(P)),j+=2*(20*y(6*P*h)+20*y(2*P*h))/3,j+=2*(20*y(P*h)+40*y(P/3*h))/3,a=j+=2*(150*y(P/12*h)+300*y(P/30*h))/3,M=2*(p=o-105)-100+3*(S=i-35)+.2*S*S+.1*p*S+.2*d(g(p)),M+=2*(20*y(6*p*h)+20*y(2*p*h))/3,M+=2*(20*y(S*h)+40*y(S/3*h))/3,u=M+=2*(160*y(S/12*h)+320*y(S*h/30))/3,l=y(f=i/180*h),s=d(l=1-b*l*l),[a=180*a/(m/s*v(f)*h),u=180*u/(m*(1-b)/(l*s)*h)]);return[e+w[0],n+w[1]]}function G(t,r){return a(void 0===t||void 0===r,"lon and lat are required"),a(!u(t)||!u(r),"lon and lat must be numbers"),t>=72.004&&t<=137.8347&&r>=.8293&&r<=55.8271}var M=Math.sin,P=Math.cos,C=Math.atan2,j=Math.sqrt,w=3e3*Math.PI/180;function W(t){var r=c(t,2),e=r[0]-.0065,n=r[1]-.006,o=j(e*e+n*n)-2e-5*M(n*w),i=C(n,e)-3e-6*P(e*w);return[o*P(i),o*M(i)]}function k(t){var r=c(t,2),e=r[0],n=r[1],o=j(e*e+n*n)+2e-5*M(n*w),i=C(n,e)+3e-6*P(e*w);return[o*P(i)+.0065,o*M(i)+.006]}var J={to:{GCJ02:S,BD09:l(k,S)}},q={to:{WGS84:p,BD09:k}},B={to:{WGS84:l(p,W),GCJ02:W}},D=(Object.freeze||Object)({WGS84:J,GCJ02:q,BD09:B});function O(t,r,e){a(!t,"input is required"),a(!r,"fromCRS is required"),a(!e,"toCRS is required");var n=D[r];a(!n,"fromCRS is invalid");var o=n.to[e];a(!o,"toCRS is invalid");var i=void 0===t?"undefined":s(t);a("string"!==i&&"object"!==i,"input must be an geojson or an array of position"),"string"===i&&(t=JSON.parse(t));var l=!1;f(t)&&(a(t.length<2,"position must be at 2 numbers long"),a(!u(t[0])||!u(t[1]),"position must contain numbers"),l=!0);var c=null,y=o;return l?c=y(t):(!function t(r,e,n){if(null!==r)for(var o=void 0,i=void 0,a=void 0,u=void 0,f=void 0,l=void 0,s=void 0,c=0,y=0,v=void 0,d=r.type,g="FeatureCollection"===d,h="Feature"===d,m=g?r.features.length:1,b=0;b<m;b++){f=(v=!!(s=g?r.features[b].geometry:h?r.geometry:r)&&"GeometryCollection"===s.type)?s.geometries.length:1;for(var p=0;p<f;p++){var S=0,G=0;if(null!==(u=v?s.geometries[p]:s)){l=u.coordinates;var M=u.type;switch(c=!n||"Polygon"!==M&&"MultiPolygon"!==M?0:1,M){case null:break;case"Point":if(!1===e(l,y,b,S,G))return!1;y++,S++;break;case"LineString":case"MultiPoint":for(o=0;o<l.length;o++){if(!1===e(l[o],y,b,S,G))return!1;y++,"MultiPoint"===M&&S++}"LineString"===M&&S++;break;case"Polygon":case"MultiLineString":for(o=0;o<l.length;o++){for(i=0;i<l[o].length-c;i++){if(!1===e(l[o][i],y,b,S,G))return!1;y++}"MultiLineString"===M&&S++,"Polygon"===M&&G++}"Polygon"===M&&S++;break;case"MultiPolygon":for(o=0;o<l.length;o++){for(G=0,i=0;i<l[o].length;i++){for(a=0;a<l[o][i].length-c;a++){if(!1===e(l[o][i][a],y,b,S,G))return!1;y++}G++}S++}break;case"GeometryCollection":for(o=0;o<u.geometries.length;o++)if(!1===t(u.geometries[o],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}(t,function(t){var r=y(t);t[0]=r[0],t[1]=r[1]}),c=t),c}var E={WGS84:r,WGS1984:e,GCJ02:n,BD09:o,EPSG4326:i,transform:O};t.WGS84=r,t.WGS1984=e,t.GCJ02=n,t.BD09=o,t.EPSG4326=i,t.transform=O,t.default=E,Object.defineProperty(t,"__esModule",{value:!0})});